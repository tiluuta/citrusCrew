<html>
    <head>
        <meta charset="UTF-8">
        <link href="stylesheet.css" rel="stylesheet" type="text/css">
        <!-- FONTS -->
        <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400&display=swap" rel="stylesheet">
        <!-- ICONS -->
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"/>
    </head>
    <body style="background-color:black;">
        <div id="navbar">
            <span class="material-symbols-outlined icon">apps</span>
            <span class="material-symbols-outlined icon"><a href="orderform.html">shopping_cart</a></span>
            <span class="material-symbols-outlined icon"><a href="contact.html">contact_support</a></span>
        </div>
        <div id="outercontainer">
            <div class="row" style="justify-content:center;">
                <img src="ring_transparent.png" style="width:200px;">
                <div class="bigtitle" style="color:white;">Keyring.</div>
            </div>
            <br>

            <div id="orderform">
            <div class="box" style="text-align:left;">
                <h1>Cart</h1>
                <p>Change customization</p>
                <p>Increase/Decrease quantity</p>
                <p>Remove from cart</p>
            </div>

            <br>

            <div class="box" style="text-align:left;">
                <h1>Contact</h1>
                <form>
                    <div class="row">
                        <input type="text" placeholder="First Name">
                        <input type="text" placeholder="Last Name">
                    </div>
                    <input type="text" placeholder="Valid Email Address" id="email">
                    <div class="error" id="validemail"></div>
                    <input type="text" placeholder="Phone Number (Optional)" id="phone">
                    <div class="error" id="validphone"></div>
                    

                    
                </form>
                <br>
                <h1>Shipping</h1>
                    <input type="text" style="width:100%;" placeholder="Address 1">
                    <input type="text" style="width:100%;" placeholder="Address 2 (Optional)">
                    <div class="row">
                        <input type="text" placeholder="City">
                        <input type="text" placeholder="State">
                        <input type="text" placeholder="ZIP Code" id="zip">
                    </div>
                
                <br>
                <h1>Payment Options</h1>
                <p>Paypal</p>
                <p>Apple Pay</p>
            </div>

            <br>

            <div class="box" style="text-align:left;">
                <h1>Order Summary</h1>
                <p>Tax: <div id="tax">&nbsp;</div></p>
                <p>Shipping fee</p>
                <p>Total Calculation</p>

                <div class="row" style="text-align:center;">
                    <div class="darkbutton" style="margin-top:50px;width:100px;">Order Now</div>
                    <div class="roundbutton" style="margin-top:50px;width:80px;">Cancel</div>
                </div>
            </div>

            
            
        </div>

        <script>

            removespaces = function(input){
                input = input.replace(/ /g, "");
                return input;
            }
            function removecharacters(input){
                input = input.replace(/,/g, "");
                input = input.replace(/\./g,"");
                return input;
            }
            checkemail = function(input){
                let atposition = input.indexOf("@");
                if (atposition < 0 || input.indexOf(".",atposition) < 0){
                    document.querySelector("#validemail").innerHTML = "Please enter a valid email address with a domain.";
                } else
                document.querySelector("#validemail").innerHTML = "";
            }
            checkphone = function(input){
                let atposition = input.indexOf("(");
                if (atposition < 0 || input.indexOf(")",atposition) < 0 || input.indexOf("-") != 8){
                    document.querySelector("#validphone").innerHTML = "Please enter a phone number with the format (***)***-****.";
                } else
                document.querySelector("#validphone").innerHTML = "";
            }
            findtax = function(input){
                let zip = "";
                if(input.length == 5){
                    zip = input;   
                    
                    fetch(url,options)
                        .then((response) => {
                            return response.json();
                        })
                        .then((data) => {
                            alert(url);
                            let html = '';
                            alert(`${data.combined_rate}`);

                            let htmlSegment = `${data.combined_rate}`;
                            html += htmlSegment;

                            document.getElementById("tax").innerHTML = html;
                        })
                        .catch(err => console.error(err));


                }
            }



            /* SALES TAX */
            const options = {
                method: 'GET',
                headers: {
                    'X-RapidAPI-Key': 'aca23fd5c4msh49ba7067f459322p172036jsn3b6b1f994257',
                    'X-RapidAPI-Host': 'sales-tax-rates1.p.rapidapi.com'
                }
            };
            
            document.querySelector("#email").addEventListener("keypress",function(){
                checkemail(document.querySelector("#email").value);
            })
            document.querySelector("#phone").addEventListener("keypress",function(){
                document.querySelector("#phone").value = removespaces(document.querySelector("#phone").value);
                checkphone(document.querySelector("#phone").value);
            })
            document.querySelector("#zip").addEventListener("keypress",function(){
                findtax(document.querySelector("#zip").value)
            })

            const url = 'https://sales-tax-rates1.p.rapidapi.com/v/api/?zip=' + document.querySelector("#zip").value;

            

            /*
            async function getData(zip){
                let url = 'https://sales-tax-rates1.p.rapidapi.com/v/api/?zip=' + zip;
                try {
                    let res = await fetch(url, options);
                    return await res.json();
                } catch (error){
                    console.log(error);
                }
            }

            async function renderData(zip){
                let taxrate = await getData(zip);

                taxrate.forEach(zip => {
                    html = ${data.combined_rate};

                });

                
            }
            */



        </script>




        </div>
        <div id="footer">
            <div class="row" style="align-items:flex-start;gap:30%;">
            <div class="bigtitle">Keyring.</div>
            <div class="column" style="margin-top:50px;">
                <a href="main.html">Home.</a>
                <a href="store.html">Store.</a>
                <a href="features.html">How to use.</a>
                <a href="learn.html">How it works.</a>
                <a href="usecases.html">Use cases.</a>
                <a href="contact.html">Contact us.</a>
            </div>
        </div>
        </div>


    </body>



</html>